## 웹 서버 소스코드 설치

https://httpd.apache.org/download.cgi

<img width="512" height="301" alt="image" src="https://github.com/user-attachments/assets/31ca8e49-c9ff-4bac-86d6-4e3f9cad308e" />

*단 다른 웹서버가 있으면 안되니까 dnf remove -y httpd


#### Server A

curl -O https://dlcdn.apache.org/httpd/httpd-2.4.65.tar.bz2<br/>
tar xfj(bz2이니까) httpd-2.4.65.tar.bz2<br/>
mv httpd-2.4.65 /opt<br/>
cd /opt/<br/>
<br/>
소스 코드 -> 컴파일(번역)<br/>
<br/>

dnf -y install gcc gcc-c++ expat expat-devel<br/>
curl -O ***<br/>
*컴파일 도구<br/>

mv /opt/httpd-2.4.65 /usr/local/src/<br/>
mv /root/다운로드/* /usr/local/src/<br/>
cd /usr/local/src<br/>
<br/>
tar xfz https://dlcdn.apache.org//apr/apr-1.7.6.tar.gz<br/>
tar xfz https://dlcdn.apache.org//apr/apr-util-1.6.3.tar.gz<br/>
<br/>

*httpd-2.4.65/srcbli/ 안에 apr-1.7.6 -> apr , apr-util-1.6.3 -> apr-util이름으로 바꾸기<br/>

mv apr-1.7.6 httpd-2.4.65/srclib/apr<br/>
mv apr-util-1.6.3 httpd-2.4.65/srclib/apr-util<br/>

wget https://github.com/PCRE2Project/pcre2/releases/download/pcre2-10.47/pcre2-10.47.tar.bz2<br/>
tar xfj pcre2-10.47.tar.bz2<br/>

*소스 코드 기반 설치<br/>
configure - make - makeinstall 3단계<br/>
**가끔식 문제에서 *cmake -makeinstall로 나오면 mysql<br/>
<br/>
cd /usr/local/src/pcre2-10.47<br/>
./configure --prefix=/usr/local/pcre<br/>
*prefix = 설치 경로<br/>
**configure - Makefile을 만들어준다(대문자 주의)<br/>
make<br/>

make install<br/>
ll /usr/local/pcre/<br/>
cd /usr/local/src/httpd-2.4.65<br/>
./configure  --prefix=/usr/local/apache --enable-so --enable-mods-shared=all --with-include-apr --with-pcre=/usr/local/pcre/bin/pcre2-config<br/>
<br/>
* --enable-so 아파치 구동 중 모듈을 불러올 수 있게 하는 기능<br/>
* --enable-mods-shared=all 아파치가 모듈을 .so라는 파일 형태로 만들어서 연결<br/>
* --with-include-apr apr 라이브러리 같이 설치<br/>
* --with-prce 해당 경로의 pcre 같이 설치<br/>

make<br/>
make install<br/>

ls /usr/local/apache/
/usr/local/apache/htdocs -> /var/www/html와 같은 컨텐츠 디렉터리

#### PHP 포함 설치

https://www.php.net/downloads.php?usage=web&os=linux&osvariant=linux-redhat&version=default&source=Y

wget https://www.php.net/distributions/php-8.4.14.tar.xz<br/>
tar xfJ(xz라서) php-8.4.14.tar.xz<br/>
<br/>
dnf -y install libxml2 libxml2-devel sqlite-devel<br/>


*configure 시 php는 아파치와 연동되어야 하므로 아파치 내부의 파일들을 지정<br/>
cd php-8.4.14<br/>
./configure --with-apxs2=/usr/local/apache/bin/apxs --with-config-file-path=/usr/local/apache/conf<br/>

make<br/>
make install<br/>
ls /usr/local<br/>

*php 디렉터리 내부의 ini 파일을 apache에 복사<br/>
cp php.ini-production /usr/local/apache/php.ini<br/>

*php 확장자를 아파치에 등록<br/>
vi /etc/httpd/conf/httpd.conf -> /usr/local/apache/conf/httpd.conf<br/>
>:403<br/>
>AddType application/x-httpd-php .php .html .html .inc .php8<br/>
>AddType application/x-httpd-php-source .phps<br/>

systemctl start httpd<br/>
*dnf로 유닛이 자동 생성된 경우에만 사용 가능<br/>

cd /usr/local/apache/bin<br/>
*apachectl 명령 - 웹 서버 기동 명령어<br/>

./apachectl start<br/>
*오류 발생 시 상기한 설정 파일의 207행에서 ServerName 부분을 수정<br/>
vi /usr/local/apache/conf/httpd.conf<br/>
>:207<br/>


firewall-cmd --add-service=httpd<br/>
firewall-cmd --runtime-to-permanent<br/>
<br/>
*window에서 접속시도<br/>
*/usr/local/apache/htdocs/index.html을 수정해보기<br/>


vi test.php<br/>
<?php<br/>
phpinfo();<br/>
?><br/>








